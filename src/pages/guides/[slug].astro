---
import Layout from '../../layouts/Layout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const guides = await getCollection('guides');
  return guides.map(guide => ({
    params: { slug: guide.data.slug },
    props: { guide },
  }));
}

const { guide } = Astro.props;
const { Content } = await render(guide);
---

<Layout title={guide.data.title} description={guide.data.description} currentPath={`/guides/${guide.data.slug}`} ogType="article">
  <main class="guide-page">
    <article>
      <header>
        <span class="badge">üìç Borough Guide</span>
        <h1>{guide.data.title}</h1>
        <p class="description">{guide.data.description}</p>
        <div class="meta">
          <time datetime={guide.data.publishedDate}>Published {new Date(guide.data.publishedDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</time>
          {guide.data.updatedDate && guide.data.updatedDate !== guide.data.publishedDate && (
            <span> ¬∑ Updated {new Date(guide.data.updatedDate).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}</span>
          )}
        </div>
      </header>
      <div class="content">
        <Content />
      </div>
      <footer>
        <a href="/boardroom-nyc/blog/">‚Üê Back to all posts</a>
      </footer>
    </article>
  </main>
</Layout>

<style>
  .guide-page { max-width: 720px; margin: 0 auto; padding: 2rem 1rem; }
  .badge { background: #2d6a4f; color: #b7e4c7; padding: 2px 10px; border-radius: 4px; font-size: 0.85rem; font-weight: 600; }
  header { margin-bottom: 2rem; }
  h1 { font-size: 2.2rem; margin: 1rem 0 0.5rem; line-height: 1.2; }
  .description { color: var(--color-text-muted, #aaa); font-size: 1.1rem; margin-bottom: 0.5rem; }
  .meta { color: var(--color-text-muted, #888); font-size: 0.85rem; }
  .content { line-height: 1.7; }
  .content :global(h2) { margin-top: 2.5rem; font-size: 1.5rem; }
  .content :global(h3) { margin-top: 1.5rem; }
  .content :global(hr) { border: none; border-top: 1px solid var(--color-border, #333); margin: 2rem 0; }
  .content :global(a) { color: var(--color-accent, #7c3aed); }
  .content :global(ul), .content :global(ol) { padding-left: 1.5rem; }
  .content :global(li) { margin-bottom: 0.3rem; }
  footer { margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid var(--color-border, #333); }
  footer a { color: var(--color-accent, #7c3aed); text-decoration: none; }
  footer a:hover { text-decoration: underline; }
</style>

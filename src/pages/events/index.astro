---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allEvents = await getCollection('events');
const events = allEvents
  .map(e => e.data)
  .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());

const now = new Date();
const upcoming = events.filter(e => new Date(e.date) >= now);
const past = events.filter(e => new Date(e.date) < now);
---

<Layout title="Events â€” Board Room NYC" description="NYC skateboarding events, contests, jams, and meetups. Stay in the loop." currentPath="/boardroom-nyc/events/">
  <section class="events-hero">
    <div class="container">
      <h1>ğŸ“… Events</h1>
      <p class="events-hero__sub">Skate jams, contests, meetups, and more across NYC</p>
    </div>
  </section>

  <section class="events-section">
    <div class="container">
      {upcoming.length > 0 && (
        <>
          <h2 class="events-section__heading">Upcoming</h2>
          <div class="events-grid">
            {upcoming.map(event => (
              <div class="event-card event-card--upcoming">
                <div class="event-card__date">
                  <span class="event-card__month">{new Date(event.date).toLocaleString('en-US', { month: 'short' })}</span>
                  <span class="event-card__day">{new Date(event.date).getDate()}</span>
                </div>
                <div class="event-card__body">
                  <h3 class="event-card__name">{event.name}</h3>
                  <p class="event-card__meta">ğŸ“† {new Date(event.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })} Â· ğŸ• {event.time} Â· ğŸ“ {event.location}</p>
                  <p class="event-card__desc">{event.description}</p>
                  {event.link && <a href={event.link} class="event-card__link" target="_blank" rel="noopener">More Info â†’</a>}
                </div>
              </div>
            ))}
          </div>
        </>
      )}

      {past.length > 0 && (
        <>
          <h2 class="events-section__heading events-section__heading--past">Past Events</h2>
          <div class="events-grid events-grid--past">
            {past.map(event => (
              <div class="event-card event-card--past">
                <div class="event-card__date">
                  <span class="event-card__month">{new Date(event.date).toLocaleString('en-US', { month: 'short' })}</span>
                  <span class="event-card__day">{new Date(event.date).getDate()}</span>
                </div>
                <div class="event-card__body">
                  <h3 class="event-card__name">{event.name}</h3>
                  <p class="event-card__meta">ğŸ“† {new Date(event.date).toLocaleDateString('en-US', { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' })} Â· ğŸ“ {event.location}</p>
                  <p class="event-card__desc">{event.description}</p>
                </div>
              </div>
            ))}
          </div>
        </>
      )}

      {events.length === 0 && (
        <p class="events-empty">No events yet â€” check back soon! ğŸ›¹</p>
      )}
    </div>
  </section>
</Layout>

<style>
  .events-hero {
    background: var(--color-midnight);
    padding: var(--space-10) 0 var(--space-8);
    text-align: center;
  }
  .events-hero h1 {
    font-family: var(--font-display);
    font-size: var(--text-3xl);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    color: var(--color-crimson);
  }
  .events-hero__sub {
    color: var(--text-secondary);
    font-size: var(--text-lg);
    margin-top: var(--space-2);
  }
  .events-section { padding: var(--space-8) 0 var(--space-10); }
  .events-section__heading {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    color: var(--color-grip-yellow);
    margin-bottom: var(--space-6);
  }
  .events-section__heading--past {
    color: var(--text-secondary);
    margin-top: var(--space-10);
  }
  .events-grid {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }
  .event-card {
    display: flex;
    gap: var(--space-5);
    background: var(--color-concrete);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
    border: 1px solid var(--color-asphalt);
  }
  .event-card--upcoming { border-left: 3px solid var(--color-crimson); }
  .event-card--past { opacity: 0.6; }
  .event-card__date {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 60px;
  }
  .event-card__month {
    font-family: var(--font-display);
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    color: var(--color-crimson);
  }
  .event-card__day {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    color: var(--text-primary);
  }
  .event-card__name {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
    margin-bottom: var(--space-1);
  }
  .event-card__meta {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    margin-bottom: var(--space-2);
  }
  .event-card__desc {
    font-size: var(--text-sm);
    color: var(--text-secondary);
    line-height: 1.6;
  }
  .event-card__link {
    display: inline-block;
    margin-top: var(--space-3);
    color: var(--color-crimson);
    font-size: var(--text-sm);
    text-decoration: none;
  }
  .event-card__link:hover { text-decoration: underline; }
  .events-empty {
    text-align: center;
    color: var(--text-secondary);
    font-size: var(--text-lg);
    padding: var(--space-10) 0;
  }
</style>
